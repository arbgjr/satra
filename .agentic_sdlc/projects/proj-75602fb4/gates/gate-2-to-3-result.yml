# =============================================================================
# Gate Evaluation Result - Phase 2 to Phase 3
# =============================================================================
# Project: proj-75602fb4
# Gate: requirements_to_architecture (2 -> 3)
# Evaluated: 2026-01-17T16:18:44Z
# Result: PASSED
# =============================================================================

gate_result:
  gate_name: "architecture_to_planning"
  from_phase: 2
  to_phase: 3
  evaluated_at: "2026-01-17T16:18:44Z"
  evaluator: gate-evaluator

  # ---------------------------------------------------------------------------
  # OVERALL RESULT
  # ---------------------------------------------------------------------------
  passed: true
  score: 0.95
  can_proceed: true

  # ---------------------------------------------------------------------------
  # ARTIFACT CHECKS
  # ---------------------------------------------------------------------------
  artifact_checks:
    - artifact_type: "high_level_architecture"
      description: "Documento de arquitetura de alto nivel"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/high-level-architecture.yml"
      validation:
        has_pattern: true
        has_components: true
        has_data_flows: true
        has_scaling_strategy: true
      issues: []

    - artifact_type: "c4_diagrams"
      description: "Diagramas C4 (Context, Container, Component)"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/c4-diagrams/"
      validation:
        has_context: true
        has_container: true
        has_component: true
        format: "mermaid"
      issues: []

    - artifact_type: "tech_stack"
      description: "Documento de stack tecnologica"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/tech-stack.yml"
      validation:
        has_backend: true
        has_frontend: true
        has_database: true
        has_cache: true
        has_justifications: true
      issues: []

    - artifact_type: "data_model"
      description: "Modelo de dados"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/data-model.yml"
      validation:
        has_entities: true
        has_relationships: true
        has_indexes: true
        entity_count: 11
      issues: []

    - artifact_type: "api_contracts"
      description: "Contratos de API (OpenAPI)"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/api-contracts/openapi.yml"
      validation:
        openapi_version: "3.0.3"
        endpoint_count: 27
        has_schemas: true
        has_security: true
      issues: []

    - artifact_type: "threat_model"
      description: "Threat model STRIDE"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/security/threat-model-stride.yml"
      validation:
        methodology: "STRIDE"
        threats_identified: 15
        has_mitigations: true
        critical_threats_addressed: true
      issues: []

    - artifact_type: "security_controls"
      description: "Controles de seguranca"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/security/security-controls.yml"
      validation:
        controls_count: 20
        covers_authentication: true
        covers_authorization: true
        covers_data_protection: true
      issues: []

    - artifact_type: "infrastructure"
      description: "Arquitetura de infraestrutura"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/architecture/infrastructure.yml"
      validation:
        has_environments: true
        has_ci_cd: true
        has_monitoring: true
        has_cost_estimation: true
      issues: []

    - artifact_type: "adrs"
      description: "Architecture Decision Records"
      required: true
      present: true
      valid: true
      path: ".agentic_sdlc/projects/proj-75602fb4/decisions/"
      validation:
        count: 7
        has_context: true
        has_decision: true
        has_consequences: true
        has_alternatives: true
      issues: []

  # ---------------------------------------------------------------------------
  # QUALITY CHECKS
  # ---------------------------------------------------------------------------
  quality_checks:
    - name: "architecture_completeness"
      description: "Todos os componentes necessarios estao documentados"
      threshold: 0.8
      actual: 1.0
      passed: true

    - name: "nfr_coverage"
      description: "Arquitetura atende aos NFRs definidos"
      threshold: 0.9
      actual: 0.95
      passed: true
      notes:
        - "Latencia <30s: Atendido via event-driven + cache"
        - "99% uptime: Atendido via Azure Container Apps"
        - "Escalabilidade: Atendido via horizontal scaling"
        - "Seguranca: Atendido via controles STRIDE"

    - name: "security_threats_addressed"
      description: "Ameacas criticas tem mitigacoes propostas"
      threshold: 1.0
      actual: 1.0
      passed: true
      notes:
        - "3 ameacas criticas identificadas"
        - "Todas tem mitigacoes propostas"

    - name: "api_coverage"
      description: "User stories tem endpoints correspondentes"
      threshold: 0.9
      actual: 1.0
      passed: true
      notes:
        - "23 user stories"
        - "27 endpoints definidos"
        - "Todas as stories cobertas"

    - name: "data_model_normalization"
      description: "Modelo de dados normalizado"
      threshold: 0.8
      actual: 0.9
      passed: true
      notes:
        - "11 entidades"
        - "Relacionamentos bem definidos"
        - "Particionamento para tabelas grandes"

    - name: "cost_estimation"
      description: "Custo estimado dentro do budget"
      threshold: 1.0
      actual: 1.0
      passed: true
      notes:
        - "MVP: $100-150/mes"
        - "Budget definido: ate $200/mes"

  # ---------------------------------------------------------------------------
  # APPROVAL CHECKS
  # ---------------------------------------------------------------------------
  approval_checks:
    - role: "tech_lead"
      required: true
      approved: true
      approver: "arbgjr"
      approved_at: "2026-01-17T04:10:00Z"
      status: "approved"
      notes: "Arquitetura aprovada - prosseguir para Phase 3"

  # ---------------------------------------------------------------------------
  # BLOCKERS
  # ---------------------------------------------------------------------------
  blockers: []

  # ---------------------------------------------------------------------------
  # RECOMMENDATIONS
  # ---------------------------------------------------------------------------
  recommendations:
    - priority: high
      description: "Revisar threat model com security lead antes de producao"
      action: "Agendar sessao de revisao de seguranca"

    - priority: medium
      description: "Validar custos de Azure com finance"
      action: "Criar calculadora de custos detalhada"

    - priority: medium
      description: "Considerar load testing antes de MVP"
      action: "Planejar testes de carga para validar scaling"

    - priority: low
      description: "Documentar runbooks operacionais"
      action: "Criar runbooks durante Phase 5"

  # ---------------------------------------------------------------------------
  # STAKEHOLDER REVIEW
  # ---------------------------------------------------------------------------
  stakeholder_review:
    required: true
    files_for_review:
      high_priority:
        - path: ".agentic_sdlc/projects/proj-75602fb4/architecture/high-level-architecture.yml"
          description: "Arquitetura de alto nivel - padrao Event-Driven Modular Monolith"

        - path: ".agentic_sdlc/projects/proj-75602fb4/architecture/tech-stack.yml"
          description: "Stack tecnologica - .NET 8, Next.js, PostgreSQL, Redis, Azure"

        - path: ".agentic_sdlc/projects/proj-75602fb4/security/threat-model-stride.yml"
          description: "Threat model - 15 ameacas, 3 criticas"

      medium_priority:
        - path: ".agentic_sdlc/projects/proj-75602fb4/architecture/data-model.yml"
          description: "Modelo de dados - 11 entidades"

        - path: ".agentic_sdlc/projects/proj-75602fb4/architecture/api-contracts/openapi.yml"
          description: "API contracts - 27 endpoints"

        - path: ".agentic_sdlc/projects/proj-75602fb4/architecture/infrastructure.yml"
          description: "Infraestrutura - Azure Container Apps, CI/CD"

  # ---------------------------------------------------------------------------
  # NEXT PHASE
  # ---------------------------------------------------------------------------
  next_phase:
    number: 3
    name: "Implementation Planning"
    description: "Quebrar epicos em tasks, estimar effort, definir sprints"
    agents:
      - delivery-planner
      - estimation-engine
    expected_outputs:
      - "Sprint backlog"
      - "Task breakdown (todas as stories)"
      - "Estimativas de esforco"
      - "Milestones no GitHub"
      - "Issues criadas no GitHub"

  # ---------------------------------------------------------------------------
  # HUMAN APPROVAL
  # ---------------------------------------------------------------------------
  human_approval_required: true
  human_approval_received: true
  human_approval_by: "arbgjr"
  human_approval_at: "2026-01-17T04:10:00Z"
  human_approval_reason: |
    Phase 2 (Architecture) requer revisao humana antes de prosseguir para
    planejamento de implementacao. Decisoes arquiteturais afetam todo o projeto.

  human_approval_notes: |
    Aprovado pelo Product Owner (arbgjr) em 2026-01-17.
    Arquitetura revisada e aceita para prosseguir para Phase 3.

  escalation_reason: null
